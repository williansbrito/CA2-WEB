<!doctype html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<meta name="description" content="">
	<meta name="author" content="">
	<title>STEP</title>
  
    <!-- Bootstrap CSS -->
      <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootswatch/4.3.1/litera/bootstrap.min.css">
    
  </head>
  	<!-- Navigation bar-->
  <body background="#A6B3C4">
		<nav class="navbar navbar-expand-lg navbar-dark bg-dark static-top">
		<div class="container">	<a class="navbar-brand" href="#">STEP - Dance & Perfomance School</a>
			<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">	<span class="navbar-toggler-icon"></span>
			</button>
			<div class="collapse navbar-collapse" id="navbarResponsive">
				<ul class="navbar-nav ml-auto">
					<li class="nav-item active"><a class="nav-link" href="#">Home<span class="sr-only">(current)</span></a></li>
					<li class="nav-item"><a class="nav-link" onclick="document.getElementById('id01').style.display='block'">Login</a></li> <!-- Opens the login block-->
                    <li class="nav-item"><a class="nav-link" href="#">Classes Enroll</a></li>
                    <li class="nav-item"><a class="nav-link" href="#">About</a></li>
					<li class="nav-item"><a class="nav-link" href="#">Contact Us</a></li>
				</ul>
			</div>
		</div>
	</nav>

<!-- Page Content -->
	<div class="container">
		<div class="row d-flex justify-content-center">
			<div class="col-lg-12 text-center">
           			<h1 class="mt-5">Welcome to STEP - Dance & Performance School</h1>
				<h3 class="lead"> </h3>
			</div>
		</div>
	</div>

<!-- Home page details -->
<div class="card-deck">
  <div class="card mt-5"> 
    <img class="card-img-top" src="https://encrypted-tbn0.gstatic.com/images?q=tbn%3AANd9GcQ_VNkN3pUfE1GLfqDeUYnLDk4H57BsYIEEDkHFo6_ZqsSNnVEB&usqp=CAU" alt="Card image cap">
    <div class="card-body">
      <h5 class="card-title">Ballet Dance</h5>
      <p class="card-text">
         <p class="text-justify">An artistic dance form performed to music, using precise 
            nd highly formalized set steps and gestures. Our teachers will prepare 
            you on all the steps to become a professional ballet dancer or improve an existing
            skill. </p>
            <p class="text-justify">The Ballet Dance classes are divide in Beginner, Intermadiate, Advanced and Individual.</p> 
            <p class="text-justify">   Our fees varies according to the student level.</p>
            </p>
    </div>
  </div>
   <div class="card mt-5"> 
    <img class="card-img-top" src="https://encrypted-tbn0.gstatic.com/images?q=tbn%3AANd9GcRCzbt6pp85A4J98dbxBxs3_vqPyOUpzQIRad5njb4-9es0JbZ2&usqp=CAU" alt="Card image cap">
    <div class="card-body">
      <h5 class="card-title">Tap Dance</h5>
      <p class="card-text">
        <p class="text-justify">Tap dance is a type of dance characterised by using the sounds of tap shoes 
            striking the floor as a form of percussion. The sound is made by shoes that have a 
            metal "tap" on the heel and toe. 
            There are several styles of tap dance, including rhythm, classical, Broadway, and post-modern.</p>
            <p class="text-justify"> With our experienced teachers, the students will have a guidance through the levels
            of the course </p>
<p class="text-justify">  Our fees varies according to the student level.</p>  
        </p>
    </div>
  </div>
     <div class="card mt-5"> 
    <img class="card-img-top" src="https://www.differencebetween.com/wp-content/uploads/2011/04/Contemporary-Dance_Difference-Between-Modern-and-Contemporary-Dance.jpg" alt="Card image cap">
    <div class="card-body">
      <h5 class="card-title">Morden Dance</h5>
      <p class="card-text">
        <p class="text-justify">A free expressive style of dancing that developed in the early 20th century
             as a reaction to classical ballet.
             In recent years it has included elements not usually associated with dance, 
             such as speech and film.
             When you take a modern dance class, the technique you learn will vary upon the preference of the teacher.
              Since it is such an emotion-driven genre of dance, students are able to learn great variations of the craft
               by studying under different instructors.
               </p>
               <p class="text-justify">  Our fees varies according to the student level.</p>  
             <p class="text-justify"> </p>
     </p>  
    </div>
  </div>
   <div class="card mt-5"> 
    <img class="card-img-top" src="https://steemitimages.com/DQmfVJAuAYHYa8JSaSVVRXmQAPqqZUTQD873iriNNHdbd1g/TDAPC2105-0148.jpg" alt="Card image cap">
    <div class="card-body">
      <h5 class="card-title">Jazz Dance</h5>
      <p class="card-text">
            <p class="text-justify">Jazz dance is a performance dance technique and style that first 
                emerged in the United States in the early twentieth century.
                Jazz dance may refer to vernacular jazz or to Broadway or theatrical jazz.
                Both genres build on African American vernacular styles of 
                dancing that emerged with jazz music.</p>
            <p>Our school offers Jazz Dance classes for all the levels</p>
            <p class="text-justify">  Our fees varies according to the student level.</p>  
     </p>
    </div>
  </div>
</div>

     <!-- MENU REVIEW - container -->

    <div class="container">
    <br>
        <div class="row">
                <label><h4>Students Reviews:</h4></label>
            <div class="col-lg-4 text-left">
           </div>
           
         <!-- Display the input -->
           
            <div class="col-lg-12 text-justify"></div>
                <ul class="list-group" id="display">                 
                </ul>
            </div> 
        <br>
  <!--  place holder to enter the review-->
        <form id="form">
                    <div class="form-group">
                        <textarea type="text" class="form-control" id="todoUserInput" placeholder="Enter your review"></textarea>
                        <br>
                         <div class="col-lg-3">
                        <button type="submit" class="btn btn-primary btn-lg btn-block">Post</button>
                        </div>
                    </div>
                </form>

               <!-- ALERT MESSAGE -->

                  <div class="row">
                        <div class="alert col-lg-12 text-center" role="alert" id="message">
                        </div> 
                    </div> 
                 </div>


    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
  
  <script>
    $(document).ready(()=>{
        const display = $("#display");
        const form = $("#form");
        const todoUserInput = $("#todoUserInput");
        const message = $("#message");
        message.hide();

        //DISPLAY ALERT MESSAGE
        const displayMessage = (flag,msg)=>{
            //SUCCESSFUL MESSAGE DISPLAY
            if(flag){
                message.removeClass('alert-danger');
                message.addClass('alert-success');
                message.html(msg);
                message.show();
            }
            //WORNG INPUT MESSAGE DISPLAY
            else{

                message.removeClass('alert-success');
                message.addClass('alert-danger');
                message.html(msg);
                message.show();

            }
            
        }
    //GETTING ALL THE REVIEWS FROM THE DB FUNCTION
        const getTodos = ()=>{
            fetch('/getTodos',{method : "get"}).then((response)=>{
                return response.json();
            }).then((data)=>{
                console.log(data);
                displayTodos(data);
            });

        }
        getTodos();

        const resetTodosInput = () =>{

            todoUserInput.val('');
        }

//UPDATE REVIEWS FUNCTION
const editTodo = (todo,todoID,editID)=>{
    let editBtn = $(`${editID}`);
    editBtn.click(()=>{
        fetch(`/${todo._id}`,{
            method : "put",
            headers : {
                "Content-Type" : "application/json; charset=utf8"
            },
            body : JSON.stringify({todo : todoUserInput.val()})
        }).then((response)=>{
            return response.json();           
        }).then((data)=>{
            if(data.ok == 1){
                let todoIndex = $(`#${todoID}`);
                todoIndex.html(data.value.todo);
                //resetTodosInput();
            }
        })
    })
}

 //DELETE REVIEWS FUNCTION
const deleteTodo = (todo,listItemID,deleteID)=>{
    let deleteBtn = $(`#${deleteID}`);
    deleteBtn.click(()=>{
        fetch(`/${todo._id}`,{
            method: "delete"
    }).then((response)=>{
        return response.json();
    }).then((data)=>{
        if(data.ok == 1){
            $(`#${listItemID}`).remove();
        }
    });
})
}
// BUILD THE TEMPLATE FOR THE REVIEWS
        const buildIDS = (todo)=>{
            return{
                editID : "edit_" + todo._id,
                deleteID: "delete_" + todo._id,
                listItemID : "listItem_" + todo._id,
                todoID : "todo_" + todo._id
            }
        }

        const buildTemplate = (todo, ids) =>{

            return `  <li class="list-group-item" id="${ids.listItemID}">
                <div class="row">                                    
                    <div class="col-md-11" id="${ids.todoID}">${todo.todo}</div>
                    <div class="col-md-1 text-right">
                        <button type="button" class="btn btn-secondary btn-sm" id="${ids.editID}">Edit</button>
                        <button type="button" class="btn btn-danger btn-sm" id="${ids.deleteID}">Delete</button>
                    </div>  
                   </div>                              
                 </li>`;
        }
        
//DISPLAY ALL THE REVIEWS

const displayTodos = (data)=>{
    data.forEach((todo)=>{
        let ids = buildIDS(todo);
        display.append(buildTemplate(todo,ids));
        editTodo(todo,ids.todoID,ids.editID);
       deleteTodo(todo,ids.listItemID,ids.deleteID);
    });

    }
    //POSTING THE INPUT FROM THE USER
    form.submit((e)=>{
        e.preventDefault();
        fetch('/',{
            method : 'post',
            body : JSON.stringify({todo : todoUserInput.val()}),
            headers : {
                "Content-Type" : "application/json; charset=utf-8"
            }
        }).then((response)=>{
            return response.json();
        }).then((data)=>{
            if(!data.error){
                if(data.result.ok == 1 && data.result.n == 1){
                        let ids = buildIDS(data.document);
                        display.append(buildTemplate(data.document,ids));
                        editTodo(data.document,ids.todoID,ids.editID);
                        deleteTodo(data.document,ids.listItemID,ids.deleteID);
                        displayMessage(true,data.msg);
            }
        } 
            else
                displayMessage(false,data.error.message);
                 resetTodosInput();
          });
    })

   });
  </script>
  
  </body>
</html>

<!-- Code based on https://www.youtube.com/watch?v=CyTWPr_WwdI to be created-->